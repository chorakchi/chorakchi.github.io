{"version":3,"sources":["../src/WebpackCleanupPlugin.js"],"names":[],"mappings":";;;;;;;;;;;;;;kBAEe,IAAI;;;;oCACW,wBAAwB;;;;IAEhD,oBAAoB;AAEb,WAFP,oBAAoB,GAEE;QAAd,OAAO,yDAAG,EAAE;;0BAFpB,oBAAoB;;AAGtB,QAAI,CAAC,OAAO,GAAG,OAAO,CAAC;GACxB;;eAJG,oBAAoB;;WAMnB,eAAC,QAAQ,EAAE;;;AAEd,UAAM,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC;;AAEhD,cAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,UAAC,KAAK,EAAK;+BACV,MAAK,OAAO,CAA3B,OAAO;YAAP,OAAO,oCAAC,EAAE;;;AAElB,YAAM,MAAM,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;AACrC,YAAM,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,UAAA,KAAK;iBAAI,KAAK,CAAC,IAAI;SAAA,CAAC,CAAC;AAC9D,YAAM,KAAK,GAAG,uCAAkB,UAAU,CAAC,CACxC,GAAG,CAAC,UAAA,IAAI;iBAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;SAAA,CAAC,CAChC,MAAM,CAAC,UAAA,IAAI;iBAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAAA,CAAC,CAC3E,GAAG,CAAC,UAAA,IAAI;iBAAO,UAAU,SAAI,IAAI;SAAE,CAAC,CAAC;;AAExC,aAAK,CAAC,OAAO,CAAC,gBAAG,UAAU,CAAC,CAAC;;AAE7B,eAAO,CAAC,GAAG,CAAC,6CAA6C,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;OAE1E,CAAC,CAAC;KAEJ;;;SA1BG,oBAAoB;;;qBA8BX,oBAAoB","file":"WebpackCleanupPlugin.js","sourcesContent":["/* eslint no-console: 0 */\n\nimport fs from \"fs\";\nimport recursiveReadSync from \"recursive-readdir-sync\";\n\nclass WebpackCleanupPlugin {\n\n  constructor(options = {}) {\n    this.options = options;\n  }\n\n  apply(compiler) {\n\n    const outputPath = compiler.options.output.path;\n\n    compiler.plugin(\"done\", (stats) => {\n      const { exclude=[] } = this.options;\n      // recursiveReadSync returns prefix of outputPath + \"/\"\n      const offset = outputPath.length + 1;\n      const assets = stats.toJson().assets.map(asset => asset.name);\n      const files = recursiveReadSync(outputPath)\n        .map(path => path.substr(offset))\n        .filter(file => exclude.indexOf(file) === -1 && assets.indexOf(file) === -1)\n        .map(file => `${outputPath}/${file}`);\n\n      files.forEach(fs.unlinkSync);\n\n      console.log(\"\\nWebpackCleanupPlugin: %s file(s) deleted.\", files.length);\n\n    });\n\n  }\n\n}\n\nexport default WebpackCleanupPlugin;\n"]}