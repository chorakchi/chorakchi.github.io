angular.module("ngSlimScroll",[]).directive("slimScroll",["$document","$window",function(n,w){return{restrict:"A",compile:function(f,a){var c=f[0],k=a.width||"auto",E=a.height||c.clientHeight||"100%",F=a.size||"7px",x=eval(a.alwaysVisible)||!1,y=eval(a.railVisible)||!1,J=eval(a.railBorderRadius)||"7px",K=a.railColor||"#333",L=a.railOpacity||.2,M=a.opacity||.4,N=a.color||"#000",p=a.borderRadius||"7px",O=a.position||"right",G=a.distance||"1px",P=eval(a.allowPageScroll)||!1,l=eval(a.disableFadeOut)||
!1,Q=a.wheelStep||20,R=eval(a.railDraggable)||!0,S=a.touchScrollStep||200,T=eval(a.watchContent)||!1,q=30,r=0,H=0,h=!1,t=!1,u=!1,z=!1,A=0;f.css({overflow:"hidden",width:k,height:E});var I=angular.element("<div></div>").css({position:"relative",overflow:"hidden",width:k,height:E});angular.isDefined(a.wrapperClass)&&I.addClass(a.wrapperClass);var g=angular.element("<div></div>").css({width:F,height:"100%",position:"absolute",top:0,display:x&&y?"block":"none","border-radius":J,background:K,opacity:0,
zIndex:90});angular.isDefined(a.railClass)&&g.addClass(a.railClass);var b=angular.element("<div></div>").css({background:N,width:F,position:"absolute",top:0,opacity:0,display:x?"block":"none","border-radius":p,BorderRadius:p,MozBorderRadius:p,WebkitBorderRadius:p,zIndex:99});angular.isDefined(a.barClass)&&b.addClass(a.barClass);k="right"==O?{right:G}:{left:G};g.css(k);b.css(k);var B=function(){q=Math.max(c.offsetHeight/c.scrollHeight*c.offsetHeight,30);b.css({height:q+"px",display:q>=c.offsetHeight?
"none":"block"})},C=function(){clearTimeout(H);B();h=r==~~r?P:!1;q>=c.offsetHeight?h=!0:(l?b.css({display:"block"}):b.css({transition:"opacity 0.1s linear",opacity:M}),y&&(l?g.css({display:"block"}):g.css({display:"block",transition:"opacity 0.1s linear",opacity:L})))},m=function(){x||(H=setTimeout(function(){l&&t||u||z||(l?b.css({display:"none"}):b.css({transition:"opacity 1s linear",opacity:0}),y&&(l?g.css({display:"none"}):g.css({transition:"opacity 1s linear",opacity:0})))},1E3))},v=function(d,
a,g){h=!1;var e=d,f=c.offsetHeight-b[0].offsetHeight;a&&(e=parseInt(b.css("top"),10)+d*parseInt(Q,10)/100*b[0].offsetHeight,e=Math.min(Math.max(e,0),f),e=0<d?Math.ceil(e):Math.floor(e),b.css({top:e+"px"}));r=parseInt(b.css("top"),10)/(c.offsetHeight-b[0].offsetHeight);e=r*(c.scrollHeight-c.offsetHeight);g&&(e=d,a=e/c.scrollHeight*c.offsetHeight,a=Math.min(Math.max(a,0),f),b.css({top:a+"px"}));e=0<d?Math.ceil(e):Math.floor(e);c.scrollTop=e;C();m()},D=function(d){if(t){d=d||w.event;var a=0;d.wheelDelta&&
(a=-d.wheelDelta/120);d.detail&&(a=d.detail/3);v(a,!0);d.preventDefault&&!h&&d.preventDefault();h||(d.returnValue=!1)}};if(R)b.on("mousedown",function(a){var c=parseFloat(b.css("top")),g=a.pageY;z=!0;n.on("mousemove",function(a){b.css({top:c+a.pageY-g+"px"});v(0,b[0].offsetTop,!1);a.stopPropagation();a.preventDefault();return!1});n.on("mouseup",function(){z=!1;u||m();n.off("mousemove")})}).on("selectstart",function(a){a.stopPropagation();a.preventDefault();return!1});g.on("mouseenter",function(){C()});
g.on("mouseleave",function(){m()});b.on("mouseenter",function(){u=!0});b.on("mouseleave",function(){u=!1});f.on("mouseenter",function(){t=!0;C();m()});f.on("mouseleave",function(){t=!1;m()});f.on("touchstart",function(a){a.originalEvent.touches.length&&(A=a.originalEvent.touches[0].pageY)});f.on("touchmove",function(a){h||a.originalEvent.preventDefault();a.originalEvent.touches.length&&(v((A-a.originalEvent.touches[0].pageY)/S,!0),A=a.originalEvent.touches[0].pageY)});(function(a){w.addEventListener?
(a.addEventListener("DOMMouseScroll",D,!1),a.addEventListener("mousewheel",D,!1)):n.attachEvent("onmousewheel",D)})(c);return function(a,f){f.wrap(I);f.append(b);f.append(g);B();T&&(a.$watch(function(){return c.offsetHeight/c.scrollHeight},function(a,b){b!==a&&(B(),v(0,!0))}),w.addEventListener("resize",function(){a.$apply()},!1))}}}}]);
